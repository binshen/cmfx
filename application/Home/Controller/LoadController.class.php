<?phpnamespace Home\Controller;use Common\Controller\AdminbaseController;class LoadController extends AdminbaseController {        function _initialize() {                parent::_initialize();                vendor('PHPExcel.PHPExcel');    }        function index(){                $filePath = 'C:\123.xls';                /**默认用excel2007读取excel，若格式不对，则用之前的版本进行读取*/        $PHPReader = new \PHPExcel_Reader_Excel2007();        if(!$PHPReader->canRead($filePath)){            $PHPReader = new \PHPExcel_Reader_Excel5();            if(!$PHPReader->canRead($filePath)){                echo 'no Excel';                return ;            }        }                $objPHPExcel = $PHPReader->load($filePath);                /**读取excel文件中的第一个工作表*/        $currentSheet = $objPHPExcel->getSheet(0);        /**取得最大的列号*/        $allColumn = $currentSheet->getHighestColumn();        /**取得一共有多少行*/        $allRow = $currentSheet->getHighestRow();                //dump($allColumn);        //dump($allRow);                /**从第二行开始输出，因为excel表中第一行为列名*/        for($currentRow = 2;$currentRow <= $allRow;$currentRow++){            /**从第A列开始输出*/            for($currentColumn= 'A';$currentColumn<= $allColumn; $currentColumn++){                $val = $currentSheet->getCellByColumnAndRow(ord($currentColumn) - 65,$currentRow)->getValue();/**ord()将字符转为十进制数*/                if($currentColumn == 'A')                {                    echo $val . "\t";                }else{                    //echo $val;                    /**如果输出汉字有乱码，则需将输出内容用iconv函数进行编码转换，如下将gb2312编码转为utf-8编码输出*/                    echo iconv('utf-8','gb2312', $val)."\t";                }            }            echo "</br>";        }        echo "\n";    }        function read() {                $fileName = '123.xls';        $path = 'C:\\';        $filePath = $path.$fileName;        $PHPExcel = new \PHPExcel();        $PHPReader = new \PHPExcel_Reader_Excel2007();                //为了可以读取所有版本Excel文件        if(!$PHPReader->canRead($filePath))        {            $PHPReader = new \PHPExcel_Reader_Excel5();            if(!$PHPReader->canRead($filePath))            {                echo '未发现Excel文件！';                return;            }        }                //不需要读取整个Excel文件而获取所有工作表数组的函数，感觉这个函数很有用，找了半天才找到        $sheetNames  = $PHPReader->listWorksheetNames($filePath);                //读取Excel文件        $PHPExcel = $PHPReader->load($filePath);                //获取工作表的数目        $sheetCount = $PHPExcel->getSheetCount();                //选择第一个工作表        $currentSheet = $PHPExcel->getSheet(0);                //取得一共有多少列        $allColumn = $currentSheet->getHighestColumn();                //取得一共有多少行        $allRow = $currentSheet->getHighestRow();                //循环读取数据，默认编码是utf8，这里转换成gbk输出        for($currentRow = 1;$currentRow<=$allRow;$currentRow++)        {            for($currentColumn='A';$currentColumn<=$allColumn;$currentColumn++)            {                $address = $currentColumn.$currentRow;                echo iconv( 'utf-8','gbk', $currentSheet->getCell($address)->getValue())."\t";            }            echo "<br />";        }    }}