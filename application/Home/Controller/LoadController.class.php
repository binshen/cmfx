<?phpnamespace Home\Controller;use Common\Controller\AdminbaseController;class LoadController extends AdminbaseController {    	protected $Dao;	    function _initialize() {                parent::_initialize();                vendor('PHPExcel.PHPExcel');                $this->Dao = D("Home/Broker");    }        function index() {                $fileName = '123.xls';        $path = 'C:\\';        $filePath = $path.$fileName;        $PHPExcel = new \PHPExcel();        $PHPReader = new \PHPExcel_Reader_Excel2007();                //为了可以读取所有版本Excel文件        if(!$PHPReader->canRead($filePath))        {            $PHPReader = new \PHPExcel_Reader_Excel5();            if(!$PHPReader->canRead($filePath))            {                echo '未发现Excel文件！';                return;            }        }                //不需要读取整个Excel文件而获取所有工作表数组的函数，感觉这个函数很有用，找了半天才找到        $sheetNames  = $PHPReader->listWorksheetNames($filePath);                //读取Excel文件        $PHPExcel = $PHPReader->load($filePath);                //获取工作表的数目        $sheetCount = $PHPExcel->getSheetCount();                //选择第一个工作表        $currentSheet = $PHPExcel->getSheet(1);                //取得一共有多少列        $allColumn = $currentSheet->getHighestColumn();                //取得一共有多少行        $allRow = $currentSheet->getHighestRow();                //循环读取数据，默认编码是utf8，这里转换成gbk输出                $brokers = array();        $ranks = array(        	'置业顾问' => 1,        	'初级' => 2,        	'中级' => 3,        	'高级' => 4,        	'超级' => 5,        	'超高' => 5,        	'店东' => 6,        	'总监' => 6,        	'储备店东' => 6,        	'中級' => 3,        	'高級' => 4,        	'超級' => 5
        );                for($currentRow = 2;$currentRow<=$allRow;$currentRow++)        {//             for($currentColumn='A';$currentColumn<=$allColumn;$currentColumn++)//             {//                 $address = $currentColumn.$currentRow;//                 echo iconv( 'utf-8','gbk', $currentSheet->getCell($address)->getValue())."\t";                //                 //$name = $currentSheet->getCell($address)->getValue();//                 //$this->Dao->add(array('name' => $name));//             }			$name = trim($currentSheet->getCell("A".$currentRow)->getValue());			$tel = $currentSheet->getCell("B".$currentRow)->getValue();			$date = gmdate("Y-m-d",\PHPExcel_Shared_Date::ExcelToPHP($currentSheet->getCell("C".$currentRow)->getValue()));			$level = $currentSheet->getCell("D".$currentRow)->getValue();			$parent = trim($currentSheet->getCell("E".$currentRow)->getValue());			$id = $this->Dao->add(array(				'name' =>  $name,				'tel' => $tel,				'rank_id' => $ranks[$level],				'status' => 1,				'date' => $date,				'parent_id' => empty($brokers[$parent]) ? 0 : $brokers[$parent],				'password' => sha1('888888')
			));            			$brokers[$name] = $id;        }    }}