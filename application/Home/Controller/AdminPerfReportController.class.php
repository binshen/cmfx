<?phpnamespace Home\Controller;use Common\Controller\AdminbaseController;class AdminPerfReportController extends AdminbaseController {        protected $Dao;        function _initialize() {                parent::_initialize();        $this->Dao = D("Home/Store");    }        function index(){                $map = array();        if(IS_POST) {            $store = I('post.store');            if(!empty($store)) {                $map['sd_store.id'] = $store;            }            $this->assign('store', $store);                        $start_date = I('post.start_date');            $end_date = I('post.end_date');        } else {            $start_date = date('Ym', strtotime('-3 month'));            $end_date = date('Ym', strtotime('-1 month'));        }                  $this->assign('start_date', $start_date);        $this->assign('end_date', $end_date);                $dates = getMonthList(date('Y-m', strtotime($start_date.'01')), date('Y-m', strtotime($end_date.'01')));        $storePerfs = $this->Dao            ->join('sd_broker ON sd_broker.id = sd_store.manager_id')            ->field('sd_broker.id, sd_store.name AS sname, sd_broker.name AS bname')            ->where($map)            ->select();        $storePerfList = array();        foreach ($storePerfs as $s) {            foreach ($dates as $d) {                $s['date'] = $d;                $s['perf'] = getSelfStoreProfit($s['id'], $s['date']);                $storePerfList[] = $s;            }        }        $this->assign('storePerfList', $storePerfList);                $storeList = $this->Dao->select();        $this->assign('storeList', $storeList);                $this->display();    }}